BTEQ 16.20.00.07 (32-bit) Sat Jan 28 01:03:41 2023 PID: 18743698
 
+---------+---------+---------+---------+---------+---------+---------+----

LOGON tdtp01s2/usr_carga_desa,

 *** Logon successfully completed.
 *** Teradata Database Release is 16.20.53.55                   
 *** Teradata Database Version is 16.20.53.55                     
 *** Transaction Semantics are BTET.
 *** Session Character Set Name is 'ASCII'.
 
 *** Total elapsed time was 1 second.
 
+---------+---------+---------+---------+---------+---------+---------+----

DATABASE bddwedqd;

 *** New default database accepted. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+----

.SET FORMAT OFF;
+---------+---------+---------+---------+---------+---------+---------+----
.SET WIDTH 32000;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
.SET SEPARATOR '|';
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
.SET TITLEDASHES OFF;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

SEL CURRENT_TIMESTAMP;

 *** Query completed. One row found. One column returned. 
 *** Total elapsed time was 1 second.

            Current TimeStamp(6)
2023-01-28 00:48:48.080000-05:00

+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

/*========================================================================================= */
/**********************************TRANSACCIONALES******************************************/
/*========================================================================================= */

------------Genera Detalle Transaccional Comprobantes VÃ¡lidos-------------------------------

SELECT 1 FROM  dbc.TablesV WHERE databasename = 'bddwestgd' AND TableName = 'tmp093168_kpi17_detcpeval_tr';

 *** Query completed. No rows found. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
.IF activitycount = 0 THEN .GOTO ok
.GOTO ok
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

DROP TABLE bddwestgd.tmp093168_kpi17_detcpeval_tr;
 *** Skipped.
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.IF ERRORCODE <> 0 THEN .GOTO error_shell;
 *** Skipped.
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.label ok;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-


CREATE MULTISET TABLE bddwestgd.tmp093168_kpi17_detcpeval_tr
AS
(
SELECT 
 DISTINCT
 TRIM(x0.num_ruc) as num_ruc, 
 coalesce(x2.ind_presdj,0) as ind_presdj,
 x0.ann_ejercicio,
 TRIM(x0.num_ruc_emisor) as num_ruc_emisor,
 TRIM(x0.cod_tip_doc) as cod_tip_doc,
 TRIM(x0.ser_doc) as ser_doc,
 TRIM(x0.num_doc) as num_doc,
 x0.mto_doc_fin_mn,
 x0.mto_deduccion_fin
FROM bddwestgd.t8156cpgastodeduc x0 
LEFT JOIN bddwestgd.ddp x1 ON x0.num_ruc_emisor = x1.ddp_numruc 
LEFT JOIN bddwestgd.tmp093168_kpiperindj x2 on x0.num_ruc=x2.num_ruc
WHERE x0.ann_ejercicio = '2022' 
AND x0.ind_tip_gasto = '03' 
AND x0.ind_estado = '1'
AND x0.fec_doc >= CAST('2022-01-01' AS DATE FORMAT 'YYYY-MM-DD') 
AND x0.fec_doc <= CAST('2022-12-31' AS DATE FORMAT 'YYYY-MM-DD')
)
WITH DATA NO PRIMARY INDEX;

 *** Table has been created. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-


.IF ERRORCODE <> 0 THEN .GOTO error_shell;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-


/***************************FVIRTUAL**************************************************/

------- Genera Detalle en FVIRTUAL----------------------


SELECT 1 FROM  dbc.TablesV WHERE databasename = 'bddwestgd' AND TableName = 'tmp093168_kpi17_detcpeval_fv';

 *** Query completed. One row found. One column returned. 
 *** Total elapsed time was 1 second.

   1
   1

+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
.IF activitycount = 0 THEN .GOTO ok
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

DROP TABLE bddwestgd.tmp093168_kpi17_detcpeval_fv;

 *** Table has been dropped. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.IF ERRORCODE <> 0 THEN .GOTO error_shell;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.label ok;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

CREATE MULTISET TABLE bddwestgd.tmp093168_kpi17_detcpeval_fv
AS
(
SELECT 
        DISTINCT 
        extract(year from fec_comprob) as ann_ejercicio,
  TRIM(a.num_ruc) as num_ruc,
  b.ind_presdj,
  TRIM(a.num_doc_emisor) as num_doc_emisor,
  TRIM(a.cod_tip_comprob) as cod_tip_comprob ,
  TRIM(a.num_serie) as num_serie,
  TRIM(a.num_comprob)  as num_comprob,
  a.mto_comprob,
  a.mto_deduccion
FROM bddwestgd.t12734cas514det a
INNER JOIN bddwestgd.tmp093168_kpiperindj b ON a.num_sec = b.num_sec 
WHERE a.cod_tip_gasto = '03'
AND a.ind_archpers = '1'  
AND a.ind_est_archpers <> '0'
) WITH DATA NO PRIMARY INDEX;

 *** Table has been created. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-


.IF ERRORCODE <> 0 THEN .GOTO error_shell;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-


/************************MONGO DB*****************************************************/

------- Genera Detalle MONGODB----------------------

SELECT 1 FROM  dbc.TablesV WHERE databasename = 'bddwestgd' AND TableName = 'tmp093168_kpi17_detcpeval_mdb';

 *** Query completed. One row found. One column returned. 
 *** Total elapsed time was 1 second.

   1
   1

+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
.IF activitycount = 0 THEN .GOTO ok
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

DROP TABLE bddwestgd.tmp093168_kpi17_detcpeval_mdb;

 *** Table has been dropped. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.IF ERRORCODE <> 0 THEN .GOTO error_shell;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.label ok;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

CREATE MULTISET TABLE bddwestgd.tmp093168_kpi17_detcpeval_mdb
AS
(
SELECT
  DISTINCT 
        extract(year from fec_comprob) as ann_ejercicio,
  TRIM(a.num_ruc) as num_ruc,
  b.ind_presdj,
  TRIM(a.num_doc_emisor) as num_doc_emisor,
  TRIM(a.cod_tip_comprob) as cod_tip_comprob ,
  TRIM(a.num_serie) as num_serie,
  TRIM(a.num_comprob)  as num_comprob,
  a.mto_comprob,
  a.mto_deduccion
FROM bddwestgd.t12734cas514det_mongodb a
INNER JOIN bddwestgd.tmp093168_kpiperindj b ON a.num_sec = b.num_sec 
WHERE a.cod_tip_gasto = '03'
AND a.ind_archpers = '1'  
AND a.ind_est_archpers <> '0'
) WITH DATA NO PRIMARY INDEX;

 *** Table has been created. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.IF ERRORCODE <> 0 THEN .GOTO error_shell
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

/*************************************************************************************/

/*======================================================================================*/
/************************Conteo para insercion en DETKPI ********************************/

---------1. Conteo transaccional

SELECT 1 FROM  dbc.TablesV WHERE databasename = 'bddwestgd' AND TableName = 'tmp093168_kpigr17_cnorigen';

 *** Query completed. One row found. One column returned. 
 *** Total elapsed time was 1 second.

   1
   1

+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
.IF activitycount = 0 THEN .GOTO ok
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

DROP TABLE bddwestgd.tmp093168_kpigr17_cnorigen;

 *** Table has been dropped. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
.IF ERRORCODE <> 0 THEN .GOTO error_shell;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.label ok;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

CREATE MULTISET TABLE bddwestgd.tmp093168_kpigr17_cnorigen AS
(
 SELECT ind_presdj,sum(mto_deduccion_fin) as mto_deduc_origen
 FROM bddwestgd.tmp093168_kpi17_detcpeval_tr
 GROUP BY 1
) WITH DATA NO PRIMARY INDEX;

 *** Table has been created. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.IF ERRORCODE <> 0 THEN .GOTO error_shell;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-


---------2. Conteo en FVirtual

SELECT 1 FROM  dbc.TablesV WHERE databasename = 'bddwestgd' AND TableName = 'tmp093168_kpigr17_cndestino1';

 *** Query completed. One row found. One column returned. 
 *** Total elapsed time was 1 second.

   1
   1

+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
.IF activitycount = 0 THEN .GOTO ok
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

DROP TABLE bddwestgd.tmp093168_kpigr17_cndestino1;

 *** Table has been dropped. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
.IF ERRORCODE <> 0 THEN .GOTO error_shell;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.label ok;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

CREATE MULTISET TABLE bddwestgd.tmp093168_kpigr17_cndestino1 AS
(
 SELECT ind_presdj,sum(mto_deduccion) as mto_deduc_destino1
 FROM bddwestgd.tmp093168_kpi17_detcpeval_fv
 GROUP BY 1
) WITH DATA NO PRIMARY INDEX;

 *** Table has been created. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.IF ERRORCODE <> 0 THEN .GOTO error_shell;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-



--------3 Conteo en MongoDB

SELECT 1 FROM  dbc.TablesV WHERE databasename = 'bddwestgd' AND TableName = 'tmp093168_kpigr17_cndestino2';

 *** Query completed. One row found. One column returned. 
 *** Total elapsed time was 1 second.

   1
   1

+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
.IF activitycount = 0 THEN .GOTO ok
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

DROP TABLE bddwestgd.tmp093168_kpigr17_cndestino2;

 *** Table has been dropped. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
.IF ERRORCODE <> 0 THEN .GOTO error_shell;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.label ok;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

CREATE MULTISET TABLE bddwestgd.tmp093168_kpigr17_cndestino2 AS
(
 SELECT ind_presdj,sum(mto_deduccion) as mto_deduc_destino2
 FROM bddwestgd.tmp093168_kpi17_detcpeval_mdb
 GROUP BY 1
) WITH DATA NO PRIMARY INDEX;

 *** Table has been created. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-


.IF ERRORCODE <> 0 THEN .GOTO error_shell;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-



/********************INSERT EN TABLA FINAL***********************************/
    
    DELETE FROM bddwedqd.T11908DETKPITRIBINT 
    WHERE COD_KPI='K017012022'  AND FEC_CARGA=CURRENT_DATE;

 *** Delete completed. No rows removed. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
    
    .IF ERRORCODE <> 0 THEN .GOTO error_shell;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
    
 INSERT INTO bddwedqd.T11908DETKPITRIBINT 
 (COD_PER,IND_PRESDJ,COD_KPI,FEC_CARGA,MTO_REGORIGEN,MTO_REGIDESTINO)
 SELECT '2022',z.ind_presdj,
        'K017012022' ,
         CURRENT_DATE,
         SUM(z.mto_origen),
         SUM(z.mto_destino)
 FROM
  (
   SELECT
          x0.ind_presdj,
          x0.mto_deduc_origen as mto_origen,
          coalesce(x1.mto_deduc_destino1,0) as mto_destino
   FROM bddwestgd.tmp093168_kpigr17_cnorigen x0
   LEFT JOIN bddwestgd.tmp093168_kpigr17_cndestino1 x1 
   ON x0.ind_presdj=x1.ind_presdj
  ) z
 GROUP BY 1,2,3,4
 ;

 *** Insert completed. No rows added. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

 .IF ERRORCODE <> 0 THEN .GOTO error_shell;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

    DELETE FROM bddwedqd.T11908DETKPITRIBINT 
    WHERE COD_KPI='K017022022'  AND FEC_CARGA=CURRENT_DATE;

 *** Delete completed. No rows removed. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
    
    .IF ERRORCODE <> 0 THEN .GOTO error_shell;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
    
 INSERT INTO bddwedqd.T11908DETKPITRIBINT 
 (COD_PER,IND_PRESDJ,COD_KPI,FEC_CARGA,MTO_REGORIGEN,MTO_REGIDESTINO)
 SELECT  '2022',z.ind_presdj,
         'K017022022',
         CURRENT_DATE,
         SUM(z.mto_origen),
         SUM(z.mto_destino)
 FROM
  (
   SELECT x0.ind_presdj,
          x0.mto_deduc_destino1 AS mto_origen,
          coalesce(x1.mto_deduc_destino2,0) AS mto_destino
   FROM bddwestgd.tmp093168_kpigr17_cndestino1 x0
   LEFT JOIN bddwestgd.tmp093168_kpigr17_cndestino2 x1 
   ON x0.ind_presdj=x1.ind_presdj
  ) z
 GROUP BY 1,2,3,4
 ;

 *** Insert completed. No rows added. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

 .IF ERRORCODE <> 0 THEN .GOTO error_shell;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-


/*=============================================================================*/
/***********************Genera Detalle de Diferencias**************************/
/*=============================================================================*/ 

SELECT 1 FROM  dbc.TablesV WHERE databasename = 'bddwestgd' AND TableName = 'tmp093168_dif_K017012022';

 *** Query completed. One row found. One column returned. 
 *** Total elapsed time was 1 second.

   1
   1

+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
.IF activitycount = 0 THEN .GOTO ok
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

DROP TABLE bddwestgd.tmp093168_dif_K017012022 ;

 *** Table has been dropped. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
.IF ERRORCODE <> 0 THEN .GOTO error_shell;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.label ok;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

    CREATE MULTISET TABLE bddwestgd.tmp093168_dif_K017012022 AS (
     SELECT DISTINCT 
   'K017012022' cod_kpi,
   y0.ann_ejercicio,
   y0.num_ruc,
   y0.ind_presdj,
   y0.num_ruc_emisor,
   y0.cod_tip_doc,
   y0.ser_doc,
   y0.num_doc,
   y0.mto_deduccion_fin 

 FROM (
  SELECT   ann_ejercicio,
     num_ruc,
     ind_presdj,
     num_ruc_emisor,
     cod_tip_doc,
     ser_doc,
     num_doc,
     mto_deduccion_fin
  FROM bddwestgd.tmp093168_kpi17_detcpeval_tr
  EXCEPT ALL
  SELECT  ann_ejercicio,
   num_ruc,
   ind_presdj,
   num_doc_emisor,
   cod_tip_comprob,
   num_serie,
   num_comprob,
   mto_deduccion
  FROM bddwestgd.tmp093168_kpi17_detcpeval_fv
 ) y0
 ) WITH DATA NO PRIMARY INDEX;

 *** Table has been created. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

    .IF ERRORCODE <> 0 THEN .GOTO error_shell;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

 .EXPORT FILE /work1/teradata/dat/093168/DIFF_K017012022_20230128.unl;
 *** Warning: No data format given. Assuming REPORT carries over.
 *** To reset export, type .EXPORT RESET
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

 LOCK ROW FOR ACCESS
 SELECT * FROM bddwestgd.tmp093168_dif_K017012022 ;

 *** Query completed. No rows found. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

 .IF ERRORCODE <> 0 THEN .GOTO error_shell;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

 .EXPORT RESET;
 *** Output returned to console.
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

SELECT 1 FROM  dbc.TablesV WHERE databasename = 'bddwestgd' AND TableName = 'tmp093168_dif_K017022022';

 *** Query completed. One row found. One column returned. 
 *** Total elapsed time was 1 second.

   1
   1

+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
.IF activitycount = 0 THEN .GOTO ok
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

DROP TABLE bddwestgd.tmp093168_dif_K017022022 ;

 *** Table has been dropped. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
.IF ERRORCODE <> 0 THEN .GOTO error_shell;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

.label ok;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
 

 CREATE MULTISET TABLE bddwestgd.tmp093168_dif_K017022022 AS (
 SELECT DISTINCT 
   'K017022022' cod_kpi,
   y0.ann_ejercicio,
   y0.num_ruc,
   y0.ind_presdj,
   y0.num_doc_emisor,
   y0.cod_tip_comprob,
   y0.num_serie,
   y0.num_comprob,
   y0.mto_deduccion
 
 FROM (
     SELECT  ann_ejercicio,
   num_ruc,
   ind_presdj,
   num_doc_emisor,
   cod_tip_comprob,
   num_serie,
   num_comprob,
   mto_deduccion
  FROM bddwestgd.tmp093168_kpi17_detcpeval_fv
  EXCEPT ALL
  SELECT  ann_ejercicio,
   num_ruc,
   ind_presdj,
   num_doc_emisor,
   cod_tip_comprob,
   num_serie,
   num_comprob,
   mto_deduccion
  FROM bddwestgd.tmp093168_kpi17_detcpeval_mdb
 ) y0
    ) WITH DATA NO PRIMARY INDEX;

 *** Table has been created. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
 
 .IF ERRORCODE <> 0 THEN .GOTO error_shell;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

 .EXPORT FILE /work1/teradata/dat/093168/DIFF_K017022022_20230128.unl;
 *** Warning: No data format given. Assuming REPORT carries over.
 *** To reset export, type .EXPORT RESET
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

    LOCK ROW FOR ACCESS
 SELECT * FROM bddwestgd.tmp093168_dif_K017022022;

 *** Query completed. No rows found. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

 .IF ERRORCODE <> 0 THEN .GOTO error_shell;
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

 .EXPORT RESET;
 *** Output returned to console.
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

/********************************************************************************/
SEL CURRENT_TIMESTAMP;

 *** Query completed. One row found. One column returned. 
 *** Total elapsed time was 1 second.

            Current TimeStamp(6)
2023-01-28 00:48:51.480000-05:00

+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

DROP TABLE bddwestgd.tmp093168_kpi17_detcpeval_tr;

 *** Table has been dropped. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
DROP TABLE bddwestgd.tmp093168_kpi17_detcpeval_fv;

 *** Table has been dropped. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
DROP TABLE bddwestgd.tmp093168_kpi17_detcpeval_mdb;

 *** Table has been dropped. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-


DROP TABLE bddwestgd.tmp093168_kpigr17_cnorigen;

 *** Table has been dropped. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
DROP TABLE bddwestgd.tmp093168_kpigr17_cndestino1;

 *** Table has been dropped. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
DROP TABLE bddwestgd.tmp093168_kpigr17_cndestino2;

 *** Table has been dropped. 
 *** Total elapsed time was 1 second.


+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-

SEL CURRENT_TIMESTAMP;

 *** Query completed. One row found. One column returned. 
 *** Total elapsed time was 1 second.

            Current TimeStamp(6)
2023-01-28 00:48:52.290000-05:00

+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-


    
LOGOFF;
 *** You are now logged off from the DBC.
+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+---------+-
QUIT 0;
 *** Exiting BTEQ...
 *** RC (return code) = 0 
  ***********************************************
  ***  J093168_KPIGRP17   ***
  ***            TERMINO PROCESO OK           ***
  ***********************************************
